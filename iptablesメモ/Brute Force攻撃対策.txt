iptables -N FW_BRUTEFORCE 2>/dev/null
iptables -N ANTI_BRUTEFORCE
iptables -N ANTI_BRUTEFORCE_
iptables -A FW_BRUTEFORCE -p tcp -m multiport --dports $LOGIN -j ANTI_BRUTEFORCE
iptables -A ANTI_BRUTEFORCE -i e+ -p tcp -m state --state NEW -j ANTI_BRUTEFORCE_
iptables -A ANTI_BRUTEFORCE -i p+ -p tcp -m state --state NEW -j ANTI_BRUTEFORCE_
iptables -A ANTI_BRUTEFORCE -i w+ -p tcp -m state --state NEW -j ANTI_BRUTEFORCE_
iptables -A ANTI_BRUTEFORCE_ \
          -m hashlimit \
          --hashlimit-name bruteforce \
          --hashlimit 1/m \
          --hashlimit-burst 7 \
          --hashlimit-mode srcip \
          --hashlimit-htable-expire 180000 \
          -j RETURN
iptables -A ANTI_BRUTEFORCE_ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-level debug --log-prefix '[IPTABLES BRUTEFORCE] : '
iptables -A ANTI_BRUTEFORCE_ -j TRACK_ATTACKER
iptables -A ANTI_BRUTEFORCE_ -j DROP
iptables -A FIREWALL -j FW_BRUTEFORCE && echo "FIREWALL	ANTI_BRUTEFORCE"
iptables -A FW_BASIC -j FW_BRUTEFORCE