#!/bin/bash

# パス
PATH=/sbin:/usr/sbin:/bin:/usr/bin
###########################################################
#JP   global IP address                                   #
###########################################################
ALLOW_ROUGHLY_HOSTS=(
 "1.0.16.0/20"
 "1.0.64.0/18"
 "1.1.64.0/18"
 "1.5.0.0/16"
 "1.21.0.0/16"
 "1.33.0.0/16"
 "1.66.0.0/15"
 "1.72.0.0/13"
 "1.112.0.0/14"
 "14.0.8.0/22"
 "14.1.4.0/22"
 "14.1.8.0/21"
 "14.3.0.0/16"
 "14.8.0.0/13"
 "14.101.0.0/16"
 "14.102.132.0/22"
 "14.102.192.0/19"
 "14.128.0.0/22"
 "14.128.16.0/20"
 "14.128.64.0/19"
 "14.128.96.0/19"
 "14.132.0.0/15"
 "14.192.32.0/20"
 "14.192.96.0/19"
 "14.193.0.0/16"
 "23.232.128.0/17"
 "24.41.112.0/20"
 "24.53.192.0/19"
 "27.0.16.0/20"
 "27.0.32.0/20"
 "27.34.128.0/19"
 "27.34.160.0/21"
 "27.34.168.0/21"
 "27.34.192.0/19"
 "27.50.96.0/19"
 "27.54.96.0/20"
 "27.54.112.0/22"
 "27.54.124.0/22"
 "27.80.0.0/12"
 "27.96.0.0/20"
 "27.96.16.0/21"
 "27.96.32.0/19"
 "27.96.68.0/22"
 "27.96.72.0/21"
 "27.96.80.0/22"
 "27.98.0.0/17"
 "27.98.128.0/18"
 "27.100.8.0/22"
 "27.100.28.0/22"
 "27.100.32.0/22"
 "27.100.48.0/20"
 "27.106.208.0/21"
 "27.106.224.0/19"
 "27.109.96.0/21"
 "27.109.120.0/22"
 "27.110.96.0/20"
 "27.110.112.0/21"
 "27.112.124.0/22"
 "27.113.192.0/19"
 "27.113.224.0/20"
 "27.113.248.0/22"
 "27.114.0.0/17"
 "27.116.0.0/20"
 "27.116.24.0/21"
 "27.118.0.0/20"
 "27.120.64.0/18"
 "27.120.128.0/20"
 "27.120.144.0/20"
 "27.120.160.0/20"
 "27.120.176.0/20"
 "27.121.0.0/18"
 "27.122.4.0/22"
 "27.122.8.0/22"
 "27.122.32.0/20"
 "27.122.48.0/21"
 "27.122.64.0/19"
 "27.122.96.0/20"
 "27.123.8.0/21"
 "27.125.204.0/22"
 "27.126.64.0/18"
 "27.126.128.0/20"
 "27.126.160.0/20"
 "27.127.0.0/17"
 "27.127.128.0/18"
 "27.127.240.0/20"
 "27.131.8.0/22"
 "27.131.16.0/20"
 "27.131.192.0/21"
 "27.131.200.0/21"
 "27.131.224.0/20"
 "27.131.240.0/21"
 "27.132.0.0/21"
 "27.132.9.0/24"
 "27.132.176.0/21"
 "27.132.184.0/21"
 "27.132.192.0/18"
 "27.133.10.0/23"
 "27.133.12.0/22"
 "27.133.24.0/21"
 "27.133.46.0/23"
 "27.133.48.0/20"
 "27.133.64.0/20"
 "27.133.90.0/23"
 "27.133.128.0/19"
 "27.133.160.0/21"
 "27.133.172.0/23"
 "27.133.175.0/24"
 "27.133.176.0/20"
 "27.133.192.0/20"
 "27.133.208.0/20"
 "27.133.224.0/22"
 "27.133.228.0/22"
 "27.133.232.0/21"
 "27.133.240.0/22"
 "27.133.244.0/23"
 "27.133.246.0/24"
 "27.133.247.0/24"
 "27.133.248.0/21"
 "27.134.0.0/20"
 "27.134.16.0/22"
 "27.134.22.0/23"
 "27.134.72.0/21"
 "27.134.80.0/20"
 "27.134.96.0/19"
 "27.134.128.0/19"
 "27.134.160.0/20"
 "27.134.176.0/21"
 "27.134.189.0/24"
 "27.134.232.0/22"
 "27.134.238.0/23"
 "27.134.240.0/20"
 "27.135.0.0/19"
 "27.135.57.0/24"
 "27.135.58.0/23"
 "27.135.60.0/22"
 "27.135.73.0/24"
 "27.147.64.0/20"
 "27.147.80.0/20"
 "27.147.96.0/20"
 "27.147.112.0/20"
 "27.228.0.0/14"
 "27.253.128.0/17"
 "36.2.0.0/15"
 "36.8.0.0/13"
 "36.52.0.0/20"
 "36.52.16.0/21"
 "36.52.26.0/23"
 "36.52.96.0/20"
 "36.52.112.0/23"
 "36.52.115.0/24"
 "36.52.117.0/24"
 "36.52.144.0/21"
 "36.52.152.0/21"
 "36.52.160.0/21"
 "36.52.168.0/22"
 "36.52.174.0/23"
 "36.52.223.0/24"
 "36.52.238.0/23"
 "36.53.0.0/17"
 "36.53.128.0/18"
 "36.53.192.0/19"
 "36.53.240.0/20"
 "36.54.0.0/15"
 "36.240.0.0/13"
 "39.2.0.0/15"
 "39.110.0.0/15"
 "42.83.0.0/18"
 "42.124.0.0/14"
 "42.187.124.0/22"
 "43.232.0.0/14"
 "43.244.0.0/16"
 "43.253.0.0/16"
 "45.75.0.0/17"
 "49.0.16.0/21"
 "49.96.0.0/12"
 "49.128.16.0/21"
 "49.128.24.0/21"
 "49.128.96.0/22"
 "49.128.100.0/22"
 "49.128.128.0/19"
 "49.129.0.0/16"
 "49.132.0.0/14"
 "49.143.240.0/21"
 "49.156.4.0/22"
 "49.156.8.0/21"
 "49.156.192.0/18"
 "49.212.0.0/16"
 "49.236.224.0/21"
 "49.236.232.0/21"
 "49.238.0.0/19"
 "49.239.64.0/18"
 "49.240.0.0/15"
 "49.242.64.0/18"
 "49.242.128.0/18"
 "49.242.192.0/18"
 "49.250.0.0/15"
 "49.252.0.0/15"
 "58.0.0.0/15"
 "58.3.0.0/17"
 "58.3.128.0/17"
 "58.4.0.0/15"
 "58.12.0.0/15"
 "58.65.32.0/19"
 "58.70.0.0/16"
 "58.80.0.0/15"
 "58.84.240.0/20"
 "58.85.0.0/16"
 "58.87.16.0/20"
 "58.87.128.0/17"
 "58.88.0.0/15"
 "58.90.0.0/15"
 "58.92.0.0/14"
 "58.98.0.0/16"
 "58.112.0.0/15"
 "58.138.0.0/17"
 "58.138.128.0/18"
 "58.145.160.0/21"
 "58.146.0.0/18"
 "58.146.64.0/19"
 "58.147.160.0/21"
 "58.147.192.0/19"
 "58.147.224.0/19"
 "58.156.0.0/15"
 "58.158.0.0/15"
 "58.183.0.0/17"
 "58.183.128.0/17"
 "58.188.0.0/14"
 "59.84.0.0/15"
 "59.86.0.0/17"
 "59.86.128.0/19"
 "59.87.0.0/16"
 "59.106.0.0/16"
 "59.128.0.0/12"
 "59.146.0.0/16"
 "59.147.0.0/16"
 "59.156.0.0/20"
 "59.156.25.0/24"
 "59.156.29.0/24"
 "59.156.135.0/24"
 "59.156.140.0/22"
 "59.156.144.0/20"
 "59.156.160.0/19"
 "59.157.208.0/20"
 "59.157.224.0/19"
 "59.158.0.0/15"
 "59.190.0.0/16"
 "59.191.128.0/18"
 "60.32.0.0/12"
 "60.56.0.0/16"
 "60.57.0.0/17"
 "60.57.128.0/17"
 "60.192.0.0/15"
 "60.236.0.0/15"
 "60.238.0.0/15"
 "60.254.192.0/18"
 "61.5.224.0/20"
 "61.5.240.0/23"
 "61.5.242.0/23"
 "61.5.244.0/24"
 "61.5.245.0/24"
 "61.8.80.0/21"
 "61.8.88.0/21"
 "61.11.128.0/19"
 "61.11.160.0/20"
 "61.11.176.0/20"
 "61.11.192.0/20"
 "61.12.128.0/17"
 "61.44.0.0/23"
 "61.44.2.0/24"
 "61.44.3.0/24"
 "61.44.16.0/20"
 "61.44.64.0/23"
 "61.44.67.0/24"
 "61.44.68.0/22"
 "61.44.128.0/18"
 "61.44.192.0/19"
 "61.44.224.0/20"
 "61.44.240.0/20"
 "61.45.0.0/17"
 "61.45.192.0/19"
 "61.45.240.0/21"
 "61.46.0.0/16"
 "61.87.0.0/21"
 "61.87.8.0/22"
 "61.87.14.0/23"
 "61.87.32.0/19"
 "61.87.64.0/18"
 "61.112.0.0/12"
 "61.192.0.0/13"
 "61.200.0.0/13"
 "61.245.0.0/17"
 "61.245.192.0/20"
 "61.245.208.0/21"
 "61.245.216.0/21"
 "64.33.0.0/18"
 "64.56.160.0/19"
 "64.63.64.0/18"
 "69.6.64.0/20"
 "76.77.48.0/20"
 "81.23.208.0/20"
 "101.1.64.0/18"
 "101.1.128.0/17"
 "101.2.128.0/19"
 "101.50.4.0/22"
 "101.50.32.0/20"
 "101.50.48.0/21"
 "101.50.60.0/22"
 "101.50.128.0/17"
 "101.53.96.0/22"
 "101.53.104.0/21"
 "101.53.112.0/20"
 "101.55.128.0/18"
 "101.55.192.0/19"
 "101.55.232.0/21"
 "101.55.240.0/20"
 "101.78.4.0/22"
 "101.96.32.0/19"
 "101.97.0.0/19"
 "101.97.64.0/18"
 "101.97.128.0/17"
 "101.102.0.0/18"
 "101.102.96.0/22"
 "101.102.128.0/17"
 "101.110.0.0/18"
 "101.110.128.0/17"
 "101.111.0.0/16"
 "101.128.128.0/17"
 "101.140.0.0/14"
 "101.203.0.0/17"
 "101.203.192.0/18"
 "103.1.244.0/22"
 "103.1.248.0/22"
 "103.1.252.0/22"
 "103.2.0.0/22"
 "103.2.4.0/22"
 "103.2.8.0/22"
 "103.2.12.0/22"
 "103.2.16.0/22"
 "103.2.20.0/22"
 "103.2.24.0/22"
 "103.2.28.0/24"
 "103.2.29.0/24"
 "103.2.30.0/23"
 "103.2.32.0/22"
 "103.2.36.0/22"
 "103.2.40.0/22"
 "103.2.44.0/22"
 "103.2.48.0/22"
 "103.2.52.0/22"
 "103.2.56.0/24"
 "103.2.57.0/24"
 "103.2.60.0/22"
 "103.2.64.0/22"
 "103.2.68.0/22"
 "103.2.96.0/22"
 "103.2.100.0/22"
 "103.2.124.0/22"
 "103.2.128.0/22"
 "103.2.136.0/22"
 "103.2.160.0/22"
 "103.2.244.0/22"
 "103.2.248.0/22"
 "103.2.252.0/22"
 "103.3.0.0/22"
 "103.3.4.0/22"
 "103.3.8.0/22"
 "103.3.12.0/22"
 "103.3.48.0/22"
 "103.3.52.0/22"
 "103.3.180.0/22"
 "103.3.184.0/22"
 "103.3.188.0/22"
 "103.4.40.0/22"
 "103.4.200.0/22"
 "103.5.20.0/22"
 "103.5.140.0/22"
 "103.5.176.0/22"
 "103.6.16.0/22"
 "103.6.44.0/22"
 "103.6.68.0/22"
 "103.6.112.0/22"
 "103.7.20.0/22"
 "103.7.208.0/22"
 "103.7.236.0/22"
 "103.8.48.0/22"
 "103.9.120.0/22"
 "103.9.172.0/22"
 "103.9.180.0/24"
 "103.10.112.0/22"
 "103.10.164.0/22"
 "103.10.240.0/22"
 "103.10.244.0/22"
 "103.11.156.0/22"
 "103.11.208.0/22"
 "103.12.16.0/22"
 "103.12.158.0/24"
 "103.13.20.0/22"
 "103.13.24.0/22"
 "103.13.60.0/22"
 "103.13.168.0/22"
 "103.13.248.0/22"
 "103.13.252.0/22"
 "103.14.12.0/22"
 "103.14.80.0/22"
 "103.15.0.0/22"
 "103.15.39.0/24"
 "103.15.68.0/22"
 "103.15.188.0/22"
 "103.16.236.0/22"
 "103.17.184.0/22"
 "103.17.188.0/22"
 "103.18.24.0/22"
 "103.18.60.0/22"
 "103.21.36.0/22"
 "103.22.152.0/22"
 "103.23.4.0/22"
 "103.23.12.0/22"
 "103.24.168.0/22"
 "103.26.152.0/22"
 "103.28.24.0/22"
 "103.28.96.0/22"
 "103.28.164.0/22"
 "103.28.236.0/22"
 "103.29.48.0/22"
 "103.29.113.0/24"
 "103.30.164.0/22"
 "103.31.244.0/22"
 "103.37.10.0/23"
 "103.39.113.0/24"
 "103.39.192.0/22"
 "103.40.104.0/22"
 "103.40.128.0/22"
 "103.41.60.0/22"
 "103.41.252.0/22"
 "103.42.168.0/22"
 "103.47.2.0/24"
 "103.48.31.0/24"
 "103.48.120.0/22"
 "103.49.88.0/22"
 "103.49.140.0/22"
 "103.51.4.0/22"
 "103.51.180.0/22"
 "103.52.128.0/22"
 "103.52.132.0/24"
 "103.53.120.0/22"
 "103.54.156.0/22"
 "103.54.204.0/22"
 "103.54.208.0/22"
 "103.55.196.0/22"
 "103.57.4.0/22"
 "103.57.48.0/22"
 "103.57.144.0/22"
 "103.59.89.0/24"
 "103.61.151.0/24"
 "103.65.44.0/22"
 "103.65.208.0/22"
 "103.66.171.0/24"
 "103.67.28.0/22"
 "103.67.220.0/22"
 "103.68.144.0/22"
 "103.70.240.0/22"
 "103.74.160.0/22"
 "103.78.118.0/23"
 "103.79.12.0/22"
 "103.81.72.0/22"
 "103.81.144.0/22"
 "103.81.176.0/22"
 "103.82.88.0/22"
 "103.84.124.0/22"
 "103.84.167.0/24"
 "103.87.144.0/22"
 "103.87.176.0/22"
 "103.90.16.0/22"
 "103.90.28.0/22"
 "103.90.164.0/22"
 "103.91.4.0/22"
 "103.91.184.0/24"
 "103.92.228.0/22"
 "103.93.60.0/22"
 "103.94.228.0/22"
 "103.95.104.0/22"
 "103.95.184.0/22"
 "103.96.64.0/22"
 "103.96.112.0/22"
 "103.96.229.0/24"
 "103.96.252.0/22"
 "103.99.80.0/22"
 "103.101.72.0/22"
 "103.102.3.0/24"
 "103.104.88.0/22"
 "103.106.48.0/22"
 "103.106.124.0/22"
 "103.108.232.0/22"
 "103.109.240.0/22"
 "103.113.56.0/22"
 "103.113.168.0/24"
 "103.113.246.0/24"
 "103.114.180.0/22"
 "103.114.184.0/22"
 "103.114.232.0/22"
 "103.115.216.0/22"
 "103.118.92.0/22"
 "103.119.88.0/22"
 "103.119.127.0/24"
 "103.120.16.0/22"
 "103.120.180.0/22"
 "103.120.184.0/22"
 "103.121.44.0/22"
 "103.192.68.0/22"
 "103.194.72.0/22"
 "103.197.12.0/22"
 "103.198.12.0/22"
 "103.198.160.0/22"
 "103.198.208.0/23"
 "103.198.210.0/24"
 "103.198.212.0/22"
 "103.199.132.0/22"
 "103.202.216.0/23"
 "103.203.156.0/22"
 "103.204.13.0/24"
 "103.204.230.0/24"
 "103.205.48.0/22"
 "103.205.168.0/22"
 "103.205.184.0/24"
 "103.208.96.0/22"
 "103.209.116.0/22"
 "103.210.84.0/22"
 "103.210.108.0/22"
 "103.211.72.0/22"
 "103.212.76.0/22"
 "103.215.56.0/22"
 "103.215.84.0/22"
 "103.224.143.0/24"
 "103.225.120.0/22"
 "103.225.152.0/22"
 "103.226.44.0/22"
 "103.226.54.0/24"
 "103.230.168.0/22"
 "103.233.196.0/22"
 "103.234.176.0/22"
 "103.235.40.0/22"
 "103.235.112.0/22"
 "103.235.124.0/22"
 "103.238.236.0/22"
 "103.238.244.0/22"
 "103.239.16.0/22"
 "103.239.108.0/22"
 "103.241.128.0/22"
 "103.241.152.0/22"
 "103.241.208.0/22"
 "103.242.28.0/22"
 "103.246.68.0/22"
 "103.246.80.0/22"
 "103.246.232.0/24"
 "103.247.84.0/22"
 "103.247.88.0/22"
 "103.247.181.0/24"
 "103.248.251.0/24"
 "103.250.72.0/22"
 "103.250.200.0/22"
 "103.251.116.0/22"
 "104.200.112.0/20"
 "104.251.144.0/20"
 "106.72.0.0/15"
 "106.128.0.0/10"
 "107.153.0.0/16"
 "110.0.0.0/14"
 "110.4.32.0/21"
 "110.4.48.0/20"
 "110.4.128.0/17"
 "110.5.0.0/18"
 "110.5.120.0/21"
 "110.44.20.0/22"
 "110.44.64.0/19"
 "110.44.128.0/20"
 "110.44.176.0/21"
 "110.50.0.0/20"
 "110.50.24.0/21"
 "110.50.64.0/20"
 "110.50.88.0/21"
 "110.50.192.0/19"
 "110.54.0.0/17"
 "110.66.0.0/15"
 "110.74.0.0/19"
 "110.74.32.0/20"
 "110.74.48.0/20"
 "110.74.64.0/20"
 "110.74.80.0/20"
 "110.74.96.0/20"
 "110.74.112.0/22"
 "110.74.117.0/24"
 "110.74.121.0/24"
 "110.74.124.0/23"
 "110.74.126.0/23"
 "110.74.224.0/19"
 "110.76.180.0/22"
 "110.92.0.0/20"
 "110.92.32.0/19"
 "110.92.80.0/20"
 "110.93.0.0/21"
 "110.93.96.0/20"
 "110.158.0.0/16"
 "110.160.0.0/14"
 "110.165.128.0/17"
 "110.172.0.0/20"
 "110.172.32.0/20"
 "110.172.48.0/22"
 "110.172.56.0/21"
 "110.173.240.0/20"
 "110.232.0.0/19"
 "110.232.120.0/21"
 "110.232.128.0/21"
 "110.232.136.0/22"
 "110.232.152.0/21"
 "110.232.160.0/20"
 "110.232.192.0/19"
 "110.232.224.0/21"
 "110.232.232.0/22"
 "110.232.236.0/22"
 "110.233.0.0/16"
 "111.64.0.0/16"
 "111.65.192.0/19"
 "111.67.112.0/20"
 "111.67.128.0/18"
 "111.68.128.0/17"
 "111.86.0.0/15"
 "111.89.0.0/16"
 "111.90.0.0/17"
 "111.91.240.0/20"
 "111.92.244.0/22"
 "111.96.0.0/12"
 "111.125.0.0/18"
 "111.125.144.0/21"
 "111.168.0.0/15"
 "111.171.128.0/17"
 "111.188.0.0/14"
 "111.216.0.0/15"
 "111.221.60.0/22"
 "111.232.0.0/15"
 "111.234.0.0/19"
 "111.234.48.0/22"
 "111.234.52.0/22"
 "111.234.120.0/22"
 "111.234.124.0/22"
 "111.234.128.0/18"
 "111.234.192.0/20"
 "111.234.218.0/23"
 "111.234.246.0/23"
 "111.235.0.0/19"
 "111.235.39.0/24"
 "111.235.40.0/22"
 "111.235.46.0/23"
 "111.235.48.0/20"
 "111.235.76.0/22"
 "111.236.0.0/14"
 "112.68.0.0/14"
 "112.78.112.0/20"
 "112.78.192.0/19"
 "112.109.0.0/20"
 "112.109.24.0/21"
 "112.136.0.0/17"
 "112.137.32.0/20"
 "112.137.56.0/21"
 "112.137.64.0/18"
 "112.137.144.0/20"
 "112.137.184.0/21"
 "112.137.192.0/18"
 "112.138.0.0/15"
 "112.140.0.0/19"
 "112.140.32.0/19"
 "112.140.128.0/20"
 "112.140.168.0/21"
 "113.20.152.0/22"
 "113.20.160.0/19"
 "113.20.192.0/18"
 "113.21.48.0/20"
 "113.21.248.0/21"
 "113.29.216.0/21"
 "113.32.0.0/13"
 "113.40.0.0/14"
 "113.52.16.0/20"
 "113.52.156.0/22"
 "113.52.240.0/20"
 "113.59.228.0/22"
 "113.61.112.0/20"
 "113.144.0.0/12"
 "113.192.128.0/17"
 "113.197.16.0/20"
 "113.197.40.0/21"
 "113.197.56.0/21"
 "113.197.128.0/17"
 "113.208.0.0/18"
 "113.212.104.0/22"
 "113.213.128.0/18"
 "113.213.192.0/19"
 "113.213.224.0/20"
 "113.213.240.0/20"
 "114.16.0.0/14"
 "114.20.0.0/15"
 "114.22.0.0/16"
 "114.31.80.0/20"
 "114.31.104.0/21"
 "114.31.216.0/21"
 "114.48.0.0/14"
 "114.69.128.0/19"
 "114.69.160.0/20"
 "114.129.0.0/21"
 "114.129.48.0/20"
 "114.134.32.0/19"
 "114.134.96.0/20"
 "114.134.112.0/20"
 "114.134.128.0/19"
 "114.134.192.0/19"
 "114.134.224.0/19"
 "114.141.32.0/21"
 "114.142.0.0/17"
 "114.142.128.0/21"
 "114.142.176.0/20"
 "114.144.0.0/12"
 "114.160.0.0/11"
 "114.192.0.0/14"
 "114.198.192.0/19"
 "114.198.224.0/21"
 "115.30.0.0/19"
 "115.30.128.0/17"
 "115.31.0.0/18"
 "115.31.80.0/21"
 "115.31.192.0/20"
 "115.31.208.0/20"
 "115.36.0.0/14"
 "115.42.96.0/20"
 "115.65.0.0/16"
 "115.69.192.0/20"
 "115.69.224.0/21"
 "115.69.232.0/21"
 "115.84.184.0/21"
 "115.85.96.0/19"
 "115.85.136.0/21"
 "115.124.48.0/20"
 "115.124.128.0/17"
 "115.125.0.0/16"
 "115.126.136.0/21"
 "115.126.144.0/20"
 "115.127.224.0/19"
 "115.146.0.0/18"
 "115.162.0.0/15"
 "115.165.0.0/17"
 "115.165.128.0/19"
 "115.165.184.0/21"
 "115.166.160.0/19"
 "115.166.192.0/20"
 "115.166.208.0/20"
 "115.166.224.0/19"
 "115.167.128.0/17"
 "115.176.0.0/15"
 "115.178.112.0/21"
 "115.179.0.0/16"
 "115.187.92.0/22"
 "116.0.128.0/17"
 "116.12.0.0/19"
 "116.50.48.0/21"
 "116.58.144.0/20"
 "116.58.160.0/19"
 "116.67.128.0/17"
 "116.68.216.0/21"
 "116.70.128.0/18"
 "116.70.192.0/18"
 "116.80.0.0/14"
 "116.89.192.0/20"
 "116.89.208.0/20"
 "116.90.144.0/20"
 "116.90.192.0/20"
 "116.91.0.0/16"
 "116.92.3.0/24"
 "116.92.5.0/24"
 "116.92.6.0/24"
 "116.92.12.0/23"
 "116.92.15.0/24"
 "116.92.16.0/20"
 "116.92.32.0/19"
 "116.92.131.0/24"
 "116.92.132.0/24"
 "116.92.134.0/23"
 "116.92.136.0/21"
 "116.92.144.0/20"
 "116.92.160.0/20"
 "116.92.176.0/21"
 "116.93.144.0/20"
 "116.94.0.0/16"
 "116.118.192.0/20"
 "116.118.208.0/20"
 "116.118.224.0/20"
 "116.193.96.0/19"
 "116.193.224.0/19"
 "116.197.168.0/21"
 "116.199.176.0/20"
 "116.199.240.0/20"
 "116.254.0.0/18"
 "116.254.64.0/19"
 "117.18.24.0/21"
 "117.18.88.0/21"
 "117.18.128.0/18"
 "117.18.192.0/20"
 "117.18.208.0/20"
 "117.20.96.0/20"
 "117.46.0.0/16"
 "117.53.0.0/19"
 "117.53.32.0/21"
 "117.55.0.0/17"
 "117.55.208.0/20"
 "117.58.144.0/20"
 "117.58.224.0/20"
 "117.74.0.0/18"
 "117.102.168.0/21"
 "117.102.176.0/20"
 "117.102.192.0/19"
 "117.103.160.0/21"
 "117.103.176.0/20"
 "117.104.0.0/18"
 "117.104.64.0/18"
 "117.104.128.0/19"
 "117.120.48.0/21"
 "118.0.0.0/12"
 "118.16.0.0/13"
 "118.27.0.0/17"
 "118.27.224.0/19"
 "118.67.64.0/19"
 "118.67.96.0/20"
 "118.82.48.0/20"
 "118.82.64.0/19"
 "118.82.96.0/19"
 "118.83.0.0/16"
 "118.86.0.0/15"
 "118.91.192.0/19"
 "118.102.40.0/21"
 "118.102.48.0/20"
 "118.103.0.0/17"
 "118.103.128.0/21"
 "118.104.0.0/15"
 "118.106.0.0/16"
 "118.107.152.0/21"
 "118.108.0.0/14"
 "118.151.0.0/17"
 "118.151.128.0/18"
 "118.151.192.0/20"
 "118.151.224.0/19"
 "118.152.0.0/14"
 "118.156.0.0/14"
 "118.177.0.0/16"
 "118.236.0.0/15"
 "118.238.0.0/17"
 "118.238.128.0/18"
 "118.238.192.0/18"
 "118.240.0.0/15"
 "118.243.0.0/16"
 "119.10.160.0/21"
 "119.10.184.0/21"
 "119.10.192.0/18"
 "119.15.32.0/19"
 "119.15.112.0/20"
 "119.15.144.0/21"
 "119.18.160.0/20"
 "119.18.176.0/21"
 "119.24.0.0/15"
 "119.26.0.0/16"
 "119.30.8.0/21"
 "119.30.192.0/18"
 "119.31.128.0/19"
 "119.47.0.0/20"
 "119.47.16.0/20"
 "119.47.32.0/19"
 "119.47.64.0/20"
 "119.47.96.0/20"
 "119.47.128.0/17"
 "119.59.64.0/21"
 "119.59.88.0/21"
 "119.63.16.0/20"
 "119.63.112.0/20"
 "119.63.144.0/20"
 "119.63.160.0/19"
 "119.63.192.0/21"
 "119.72.0.0/16"
 "119.75.224.0/20"
 "119.82.8.0/21"
 "119.82.152.0/21"
 "119.82.160.0/19"
 "119.82.192.0/20"
 "119.83.0.0/16"
 "119.104.0.0/14"
 "119.110.88.0/21"
 "119.148.104.0/21"
 "119.148.192.0/18"
 "119.150.0.0/20"
 "119.150.16.0/20"
 "119.150.32.0/19"
 "119.150.64.0/19"
 "119.150.96.0/21"
 "119.150.108.0/22"
 "119.150.112.0/20"
 "119.150.206.0/24"
 "119.150.207.0/24"
 "119.150.208.0/22"
 "119.150.213.0/24"
 "119.150.215.0/24"
 "119.150.228.0/22"
 "119.150.236.0/24"
 "119.150.237.0/24"
 "119.150.238.0/23"
 "119.150.240.0/20"
 "119.161.104.0/21"
 "119.161.112.0/21"
 "119.224.160.0/19"
 "119.224.192.0/18"
 "119.228.0.0/14"
 "119.235.104.0/21"
 "119.235.224.0/24"
 "119.235.225.0/24"
 "119.235.232.0/24"
 "119.235.233.0/24"
 "119.235.235.0/24"
 "119.235.238.0/23"
 "119.238.0.0/15"
 "119.240.0.0/14"
 "119.244.0.0/16"
 "119.245.0.0/16"
 "119.252.32.0/19"
 "120.29.144.0/21"
 "120.29.160.0/19"
 "120.50.160.0/21"
 "120.50.168.0/21"
 "120.50.192.0/20"
 "120.50.224.0/19"
 "120.51.0.0/16"
 "120.72.0.0/20"
 "120.74.0.0/15"
 "120.88.16.0/20"
 "120.88.48.0/20"
 "120.89.128.0/17"
 "120.93.0.0/16"
 "120.136.8.0/21"
 "120.136.192.0/18"
 "120.137.128.0/17"
 "120.138.128.0/18"
 "120.143.0.0/18"
 "121.0.32.0/20"
 "121.0.48.0/21"
 "121.1.128.0/17"
 "121.2.0.0/16"
 "121.3.0.0/16"
 "121.50.56.0/21"
 "121.50.152.0/21"
 "121.50.160.0/21"
 "121.58.128.0/21"
 "121.58.176.0/21"
 "121.80.0.0/14"
 "121.84.0.0/14"
 "121.92.0.0/15"
 "121.94.0.0/15"
 "121.100.8.0/21"
 "121.101.64.0/18"
 "121.102.0.0/16"
 "121.103.0.0/16"
 "121.104.0.0/14"
 "121.108.0.0/14"
 "121.112.0.0/13"
 "121.200.128.0/18"
 "121.200.200.0/21"
 "122.1.0.0/16"
 "122.16.0.0/12"
 "122.49.192.0/21"
 "122.49.232.0/21"
 "122.49.240.0/20"
 "122.50.16.0/20"
 "122.50.32.0/19"
 "122.99.104.0/21"
 "122.100.16.0/21"
 "122.100.24.0/21"
 "122.102.56.0/21"
 "122.102.128.0/17"
 "122.103.0.0/16"
 "122.128.0.0/20"
 "122.128.112.0/21"
 "122.129.160.0/19"
 "122.129.224.0/20"
 "122.130.0.0/15"
 "122.132.0.0/14"
 "122.145.0.0/19"
 "122.145.39.0/24"
 "122.145.40.0/21"
 "122.145.48.0/20"
 "122.145.64.0/19"
 "122.145.96.0/20"
 "122.145.112.0/23"
 "122.145.115.0/24"
 "122.145.116.0/22"
 "122.145.130.0/24"
 "122.145.131.0/24"
 "122.152.0.0/20"
 "122.152.16.0/20"
 "122.152.32.0/20"
 "122.152.56.0/21"
 "122.152.64.0/19"
 "122.196.0.0/15"
 "122.200.32.0/22"
 "122.200.36.0/22"
 "122.200.128.0/22"
 "122.200.136.0/21"
 "122.200.192.0/19"
 "122.200.224.0/19"
 "122.201.0.0/21"
 "122.202.16.0/21"
 "122.202.24.0/21"
 "122.202.96.0/19"
 "122.208.0.0/12"
 "122.248.64.0/19"
 "122.249.0.0/16"
 "122.250.0.0/15"
 "122.253.0.0/16"
 "122.255.76.0/22"
 "122.255.128.0/18"
 "122.255.192.0/19"
 "122.255.224.0/20"
 "122.255.240.0/20"
 "123.0.64.0/19"
 "123.0.96.0/19"
 "123.1.0.0/17"
 "123.48.0.0/16"
 "123.50.0.0/19"
 "123.50.192.0/19"
 "123.50.224.0/20"
 "123.50.240.0/20"
 "123.98.144.0/20"
 "123.98.224.0/20"
 "123.98.240.0/20"
 "123.100.192.0/19"
 "123.103.128.0/18"
 "123.103.224.0/20"
 "123.104.0.0/14"
 "123.108.152.0/21"
 "123.108.192.0/21"
 "123.108.232.0/21"
 "123.176.48.0/21"
 "123.176.104.0/21"
 "123.176.128.0/17"
 "123.198.0.0/17"
 "123.198.128.0/17"
 "123.200.32.0/19"
 "123.216.0.0/13"
 "123.224.0.0/14"
 "123.230.0.0/16"
 "123.242.208.0/20"
 "123.242.232.0/21"
 "123.254.0.0/18"
 "123.255.128.0/18"
 "123.255.192.0/21"
 "123.255.232.0/21"
 "123.255.240.0/21"
 "124.18.0.0/16"
 "124.24.0.0/16"
 "124.25.0.0/16"
 "124.26.0.0/15"
 "124.32.0.0/14"
 "124.36.0.0/14"
 "124.40.0.0/19"
 "124.40.32.0/19"
 "124.40.64.0/19"
 "124.40.96.0/20"
 "124.41.0.0/17"
 "124.41.128.0/18"
 "124.44.0.0/16"
 "124.45.0.0/16"
 "124.47.64.0/18"
 "124.47.192.0/18"
 "124.66.192.0/20"
 "124.66.224.0/19"
 "124.84.0.0/14"
 "124.96.0.0/13"
 "124.108.56.0/21"
 "124.108.192.0/18"
 "124.109.108.0/22"
 "124.109.128.0/17"
 "124.110.0.0/16"
 "124.146.64.0/19"
 "124.146.96.0/19"
 "124.146.128.0/17"
 "124.147.0.0/18"
 "124.147.64.0/18"
 "124.150.144.0/21"
 "124.150.152.0/21"
 "124.150.176.0/20"
 "124.150.192.0/18"
 "124.154.0.0/16"
 "124.155.0.0/18"
 "124.155.64.0/18"
 "124.159.0.0/16"
 "124.195.144.0/20"
 "124.208.0.0/14"
 "124.212.0.0/14"
 "124.219.128.0/17"
 "124.240.224.0/19"
 "124.241.0.0/17"
 "124.241.128.0/18"
 "124.241.192.0/19"
 "124.241.224.0/20"
 "124.241.240.0/20"
 "124.245.0.0/16"
 "124.246.128.0/17"
 "124.247.0.0/17"
 "124.247.128.0/18"
 "124.248.144.0/20"
 "124.255.0.0/16"
 "125.0.0.0/15"
 "125.2.0.0/15"
 "125.4.0.0/16"
 "125.28.0.0/15"
 "125.30.0.0/16"
 "125.31.64.0/18"
 "125.48.0.0/13"
 "125.56.0.0/17"
 "125.58.64.0/18"
 "125.62.240.0/20"
 "125.63.32.0/20"
 "125.100.0.0/14"
 "125.170.0.0/16"
 "125.172.0.0/14"
 "125.192.0.0/14"
 "125.196.0.0/14"
 "125.200.0.0/13"
 "125.214.128.0/19"
 "125.215.64.0/19"
 "125.215.96.0/19"
 "125.252.128.0/18"
 "125.254.56.0/22"
 "128.22.0.0/16"
 "128.27.0.0/16"
 "128.28.0.0/16"
 "128.53.0.0/16"
 "131.129.0.0/16"
 "131.147.0.0/16"
 "131.213.0.0/16"
 "133.0.0.0/8"
 "134.180.0.0/16"
 "138.64.0.0/16"
 "138.212.0.0/17"
 "140.227.0.0/16"
 "143.125.212.0/22"
 "143.125.216.0/21"
 "143.125.224.0/19"
 "143.189.0.0/16"
 "146.99.0.0/16"
 "146.160.0.0/16"
 "147.92.128.0/17"
 "147.192.0.0/16"
 "148.67.0.0/16"
 "148.68.0.0/16"
 "149.54.128.0/17"
 "150.31.0.0/16"
 "150.41.0.0/16"
 "150.52.0.0/16"
 "150.60.0.0/16"
 "150.66.0.0/16"
 "150.95.2.0/23"
 "150.95.32.0/19"
 "150.95.128.0/17"
 "150.147.0.0/16"
 "150.246.0.0/16"
 "150.249.0.0/16"
 "152.165.0.0/16"
 "153.120.0.0/17"
 "153.120.128.0/18"
 "153.120.192.0/20"
 "153.120.222.0/23"
 "153.120.224.0/19"
 "153.121.0.0/17"
 "153.121.128.0/17"
 "153.122.0.0/15"
 "153.124.0.0/17"
 "153.124.168.0/21"
 "153.124.176.0/20"
 "153.124.192.0/20"
 "153.124.208.0/20"
 "153.124.224.0/21"
 "153.124.232.0/21"
 "153.125.0.0/17"
 "153.125.128.0/18"
 "153.125.192.0/19"
 "153.125.224.0/20"
 "153.125.240.0/20"
 "153.126.0.0/16"
 "153.127.0.0/17"
 "153.127.128.0/18"
 "153.127.192.0/19"
 "153.127.224.0/19"
 "153.128.0.0/10"
 "153.254.0.0/15"
 "154.8.48.0/20"
 "154.33.0.0/16"
 "154.34.0.0/16"
 "157.7.32.0/19"
 "157.7.64.0/18"
 "157.7.128.0/17"
 "157.14.64.0/19"
 "157.14.96.0/19"
 "157.14.136.0/21"
 "157.14.144.0/20"
 "157.14.160.0/19"
 "157.14.192.0/20"
 "157.14.208.0/22"
 "157.14.224.0/20"
 "157.14.240.0/21"
 "157.14.252.0/22"
 "157.17.128.0/17"
 "157.65.8.0/21"
 "157.65.16.0/20"
 "157.65.32.0/19"
 "157.65.64.0/18"
 "157.65.128.0/19"
 "157.65.160.0/20"
 "157.65.176.0/21"
 "157.65.192.0/21"
 "157.65.216.0/21"
 "157.65.224.0/19"
 "157.101.0.0/18"
 "157.101.64.0/18"
 "157.101.128.0/18"
 "157.101.192.0/19"
 "157.101.224.0/19"
 "157.107.0.0/16"
 "157.112.0.0/18"
 "157.112.64.0/20"
 "157.112.99.0/24"
 "157.112.128.0/20"
 "157.112.144.0/20"
 "157.112.160.0/20"
 "157.112.176.0/20"
 "157.112.192.0/18"
 "157.120.0.0/17"
 "157.147.0.0/16"
 "157.185.192.0/18"
 "157.192.0.0/16"
 "157.250.240.0/20"
 "158.199.0.0/19"
 "158.199.32.0/19"
 "158.199.64.0/19"
 "158.199.96.0/20"
 "158.199.112.0/20"
 "158.199.128.0/17"
 "158.200.0.0/16"
 "158.201.224.0/20"
 "158.201.240.0/20"
 "159.28.64.0/18"
 "159.28.128.0/17"
 "159.80.0.0/16"
 "160.13.0.0/16"
 "160.16.0.0/16"
 "160.27.0.0/16"
 "160.86.0.0/16"
 "160.237.64.0/18"
 "160.237.128.0/18"
 "160.248.0.0/21"
 "160.248.14.0/23"
 "160.248.16.0/20"
 "160.248.32.0/19"
 "160.248.74.0/23"
 "160.248.83.0/24"
 "160.248.87.0/24"
 "160.248.90.0/23"
 "160.248.96.0/19"
 "160.248.160.0/20"
 "160.248.184.0/21"
 "160.248.203.0/24"
 "160.248.207.0/24"
 "160.248.232.0/22"
 "160.248.241.0/24"
 "160.248.242.0/23"
 "160.248.248.0/22"
 "160.248.252.0/23"
 "160.248.255.0/24"
 "160.249.0.0/16"
 "160.251.0.0/16"
 "161.34.0.0/16"
 "161.93.0.0/16"
 "161.94.0.0/15"
 "161.96.0.0/16"
 "163.43.0.0/16"
 "163.44.0.0/18"
 "163.44.64.0/18"
 "163.44.128.0/18"
 "163.44.224.0/19"
 "163.49.0.0/16"
 "163.58.0.0/16"
 "163.59.0.0/16"
 "163.131.0.0/16"
 "163.220.192.0/19"
 "164.70.0.0/17"
 "164.70.128.0/17"
 "165.76.0.0/17"
 "165.76.128.0/17"
 "165.100.128.0/18"
 "165.100.192.0/20"
 "170.199.246.0/24"
 "171.2.0.0/15"
 "172.86.208.0/20"
 "172.122.0.0/15"
 "175.28.4.0/22"
 "175.28.16.0/20"
 "175.28.48.0/22"
 "175.28.52.0/22"
 "175.28.63.0/24"
 "175.28.128.0/17"
 "175.41.32.0/21"
 "175.41.64.0/18"
 "175.45.168.0/21"
 "175.100.208.0/20"
 "175.100.224.0/19"
 "175.103.0.0/22"
 "175.103.4.0/22"
 "175.103.8.0/22"
 "175.103.12.0/22"
 "175.103.128.0/23"
 "175.103.130.0/23"
 "175.103.134.0/23"
 "175.103.144.0/21"
 "175.103.152.0/22"
 "175.103.159.0/24"
 "175.103.160.0/22"
 "175.103.164.0/23"
 "175.103.166.0/23"
 "175.103.168.0/22"
 "175.103.174.0/23"
 "175.103.176.0/23"
 "175.103.178.0/23"
 "175.103.180.0/22"
 "175.103.192.0/20"
 "175.103.216.0/21"
 "175.103.224.0/19"
 "175.104.0.0/15"
 "175.108.0.0/15"
 "175.111.64.0/20"
 "175.111.80.0/21"
 "175.111.92.0/22"
 "175.111.120.0/21"
 "175.128.0.0/13"
 "175.158.112.0/20"
 "175.176.196.0/22"
 "175.177.0.0/16"
 "175.179.0.0/16"
 "175.184.0.0/17"
 "180.0.0.0/10"
 "180.92.16.0/20"
 "180.92.32.0/19"
 "180.94.40.0/21"
 "180.94.192.0/20"
 "180.94.208.0/21"
 "180.94.240.0/20"
 "180.131.64.0/21"
 "180.131.76.0/22"
 "180.131.83.0/24"
 "180.131.96.0/21"
 "180.131.108.0/24"
 "180.131.109.0/24"
 "180.131.110.0/24"
 "180.131.111.0/24"
 "180.131.116.0/23"
 "180.131.118.0/23"
 "180.131.125.0/24"
 "180.131.126.0/24"
 "180.131.127.0/24"
 "180.131.136.0/21"
 "180.131.152.0/21"
 "180.131.192.0/20"
 "180.131.208.0/20"
 "180.131.224.0/19"
 "180.144.0.0/14"
 "180.148.28.0/22"
 "180.148.144.0/21"
 "180.148.160.0/20"
 "180.148.184.0/21"
 "180.148.192.0/20"
 "180.149.160.0/19"
 "180.149.204.0/22"
 "180.178.68.0/22"
 "180.178.80.0/21"
 "180.178.88.0/22"
 "180.188.208.0/20"
 "180.189.128.0/21"
 "180.189.224.0/19"
 "180.196.0.0/14"
 "180.200.0.0/17"
 "180.200.224.0/21"
 "180.200.248.0/22"
 "180.211.72.0/21"
 "180.211.84.0/22"
 "180.214.0.0/18"
 "180.214.224.0/21"
 "180.220.0.0/15"
 "180.222.32.0/19"
 "180.222.72.0/21"
 "180.222.80.0/20"
 "180.222.176.0/20"
 "180.233.96.0/20"
 "180.233.132.0/22"
 "180.233.136.0/21"
 "180.235.0.0/18"
 "180.235.96.0/21"
 "180.235.140.0/22"
 "180.235.144.0/22"
 "180.235.224.0/19"
 "182.16.224.0/21"
 "182.20.0.0/15"
 "182.22.0.0/17"
 "182.22.128.0/17"
 "182.23.208.0/22"
 "182.23.216.0/21"
 "182.23.224.0/19"
 "182.48.0.0/18"
 "182.50.164.0/22"
 "182.50.172.0/22"
 "182.50.192.0/19"
 "182.50.224.0/20"
 "182.54.240.0/22"
 "182.93.96.0/19"
 "182.158.0.0/15"
 "182.160.192.0/18"
 "182.161.76.0/22"
 "182.163.0.0/19"
 "182.163.32.0/19"
 "182.163.64.0/19"
 "182.164.0.0/14"
 "182.168.0.0/14"
 "182.173.128.0/19"
 "182.236.0.0/22"
 "182.236.7.0/24"
 "182.236.8.0/23"
 "182.236.10.0/23"
 "182.236.12.0/24"
 "182.236.13.0/24"
 "182.236.42.0/24"
 "182.236.43.0/24"
 "182.236.53.0/24"
 "182.236.54.0/23"
 "182.236.64.0/19"
 "182.236.96.0/20"
 "182.248.0.0/14"
 "182.255.64.0/20"
 "183.72.0.0/14"
 "183.76.0.0/15"
 "183.78.188.0/22"
 "183.81.176.0/22"
 "183.86.0.0/17"
 "183.86.128.0/18"
 "183.90.176.0/21"
 "183.90.192.0/19"
 "183.90.224.0/19"
 "183.91.96.0/19"
 "183.176.0.0/16"
 "183.177.128.0/17"
 "183.180.0.0/16"
 "183.181.0.0/18"
 "183.181.74.0/23"
 "183.181.80.0/21"
 "183.181.88.0/22"
 "183.181.92.0/23"
 "183.181.94.0/23"
 "183.181.96.0/22"
 "183.181.100.0/23"
 "183.181.102.0/24"
 "183.181.103.0/24"
 "183.181.122.0/23"
 "183.181.128.0/18"
 "183.181.192.0/18"
 "183.182.32.0/19"
 "183.182.128.0/17"
 "183.183.0.0/16"
 "192.47.90.0/23"
 "192.47.92.0/23"
 "192.47.94.0/24"
 "192.47.97.0/24"
 "192.47.144.0/20"
 "192.55.118.0/24"
 "192.58.9.0/24"
 "192.92.248.0/21"
 "192.50.0.0/16"
 "192.218.0.0/16"
 "192.244.0.0/16"
 "192.104.172.0/24"
 "192.104.247.0/24"
 "192.135.105.0/24"
 "192.146.184.0/24"
 "192.152.69.0/24"
 "192.152.212.0/24"
 "192.174.128.0/20"
 "193.114.0.0/19"
 "193.115.32.0/19"
 "193.116.32.0/19"
 "194.91.0.0/16"
 "198.144.128.0/20"
 "202.0.65.0/24"
 "202.1.208.0/20"
 "202.3.144.0/20"
 "202.4.248.0/23"
 "202.5.64.0/20"
 "202.6.68.0/22"
 "202.6.119.0/24"
 "202.7.16.0/20"
 "202.7.96.0/20"
 "202.7.112.0/20"
 "202.8.16.0/21"
 "202.8.48.0/20"
 "202.8.208.0/20"
 "202.9.208.0/20"
 "202.12.8.0/24"
 "202.12.9.0/24"
 "202.12.10.0/24"
 "202.12.11.0/24"
 "202.12.12.0/24"
 "202.12.13.0/24"
 "202.12.14.0/24"
 "202.12.15.0/24"
 "202.20.123.0/24"
 "202.20.124.0/24"
 "202.21.145.0/24"
 "202.21.146.0/24"
 "202.22.64.0/18"
 "202.22.208.0/20"
 "202.41.208.0/20"
 "202.43.16.0/20"
 "202.43.68.0/22"
 "202.43.96.0/22"
 "202.45.12.0/24"
 "202.45.129.0/24"
 "202.45.168.0/21"
 "202.47.16.0/20"
 "202.47.136.0/22"
 "202.51.4.0/22"
 "202.51.32.0/20"
 "202.51.48.0/21"
 "202.52.16.0/20"
 "202.52.151.0/24"
 "202.52.176.0/20"
 "202.53.16.0/20"
 "202.53.112.0/20"
 "202.53.208.0/20"
 "202.55.112.0/20"
 "202.55.136.0/22"
 "202.55.192.0/19"
 "202.56.64.0/20"
 "202.57.224.0/20"
 "202.58.1.0/24"
 "202.58.116.0/22"
 "202.58.144.0/20"
 "202.58.234.0/24"
 "202.59.112.0/20"
 "202.59.144.0/21"
 "202.59.176.0/20"
 "202.60.16.0/20"
 "202.60.32.0/20"
 "202.60.160.0/19"
 "202.61.1.0/24"
 "202.61.16.0/20"
 "202.62.160.0/20"
 "202.62.176.0/20"
 "202.62.253.0/24"
 "202.64.87.0/24"
 "202.64.123.0/24"
 "202.64.156.0/24"
 "202.67.16.0/20"
 "202.67.48.0/20"
 "202.69.112.0/20"
 "202.69.224.0/20"
 "202.70.140.0/24"
 "202.70.176.0/20"
 "202.70.208.0/20"
 "202.70.224.0/19"
 "202.71.48.0/20"
 "202.71.64.0/19"
 "202.72.48.0/20"
 "202.72.64.0/20"
 "202.73.64.0/20"
 "202.73.80.0/20"
 "202.73.136.0/21"
 "202.73.208.0/20"
 "202.74.16.0/20"
 "202.74.253.0/24"
 "202.75.8.0/21"
 "202.75.112.0/20"
 "202.75.224.0/21"
 "202.75.238.0/23"
 "202.76.192.0/19"
 "202.78.176.0/20"
 "202.78.208.0/20"
 "202.78.248.0/23"
 "202.79.0.0/20"
 "202.79.64.0/19"
 "202.79.128.0/19"
 "202.79.240.0/21"
 "202.80.96.0/21"
 "202.81.8.0/21"
 "202.81.80.0/20"
 "202.83.184.0/21"
 "202.83.224.0/20"
 "202.84.18.0/23"
 "202.84.48.0/20"
 "202.84.80.0/20"
 "202.86.56.0/21"
 "202.86.120.0/21"
 "202.86.240.0/21"
 "202.87.224.0/20"
 "202.88.48.0/20"
 "202.88.192.0/21"
 "202.89.80.0/20"
 "202.89.112.0/22"
 "202.89.240.0/21"
 "202.90.8.0/21"
 "202.90.208.0/20"
 "202.91.48.0/20"
 "202.91.112.0/20"
 "202.91.144.0/20"
 "202.91.208.0/20"
 "202.93.64.0/19"
 "202.93.144.0/21"
 "202.94.48.0/20"
 "202.94.128.0/19"
 "202.94.176.0/20"
 "202.94.192.0/19"
 "202.95.32.0/19"
 "202.95.176.0/20"
 "202.95.208.0/20"
 "202.95.248.0/23"
 "202.122.24.0/21"
 "202.122.48.0/20"
 "202.122.136.0/21"
 "202.122.176.0/20"
 "202.122.192.0/18"
 "202.123.184.0/21"
 "202.124.0.0/20"
 "202.124.48.0/20"
 "202.124.208.0/20"
 "202.125.48.0/20"
 "202.126.16.0/21"
 "202.126.24.0/21"
 "202.126.240.0/20"
 "202.127.80.0/20"
 "202.127.176.0/20"
 "202.129.176.0/21"
 "202.129.254.0/24"
 "202.130.60.0/22"
 "202.131.8.0/21"
 "202.131.192.0/20"
 "202.133.112.0/20"
 "202.136.192.0/20"
 "202.137.32.0/19"
 "202.137.184.0/21"
 "202.138.80.0/20"
 "202.140.0.0/19"
 "202.140.192.0/19"
 "202.141.192.0/20"
 "202.142.8.0/21"
 "202.142.224.0/19"
 "202.143.8.0/21"
 "202.143.64.0/19"
 "202.143.192.0/19"
 "202.144.224.0/19"
 "202.145.16.0/22"
 "202.145.20.0/22"
 "202.145.24.0/23"
 "202.145.26.0/23"
 "202.145.28.0/22"
 "202.146.16.0/21"
 "202.147.208.0/20"
 "202.148.240.0/20"
 "202.149.0.0/20"
 "202.149.16.0/21"
 "202.150.48.0/21"
 "202.151.96.0/19"
 "202.152.96.0/19"
 "202.152.208.0/20"
 "202.157.0.0/18"
 "202.157.224.0/19"
 "202.158.224.0/20"
 "202.161.192.0/18"
 "202.162.80.0/20"
 "202.162.112.0/20"
 "202.162.128.0/19"
 "202.163.160.0/20"
 "202.163.176.0/20"
 "202.164.64.0/19"
 "202.164.224.0/20"
 "202.164.240.0/20"
 "202.165.48.0/21"
 "202.165.112.0/21"
 "202.166.185.0/24"
 "202.168.216.0/21"
 "202.169.64.0/20"
 "202.169.80.0/20"
 "202.169.128.0/19"
 "202.169.184.0/21"
 "202.170.96.0/20"
 "202.170.176.0/20"
 "202.170.208.0/21"
 "202.171.80.0/20"
 "202.171.112.0/20"
 "202.171.128.0/19"
 "202.172.24.0/21"
 "202.172.64.0/19"
 "202.173.5.0/24"
 "202.173.96.0/20"
 "202.174.48.0/20"
 "202.174.192.0/19"
 "202.175.144.0/20"
 "202.176.16.0/20"
 "202.176.32.0/19"
 "202.177.32.0/21"
 "202.177.48.0/20"
 "202.177.64.0/18"
 "202.178.80.0/20"
 "202.179.32.0/19"
 "202.179.192.0/20"
 "202.179.208.0/20"
 "202.179.224.0/20"
 "202.180.176.0/20"
 "202.180.192.0/20"
 "202.181.96.0/20"
 "202.183.48.0/20"
 "202.183.80.0/20"
 "202.189.144.0/20"
 "202.189.176.0/21"
 "202.189.192.0/19"
 "202.191.16.0/20"
 "202.191.112.0/21"
 "203.34.81.0/24"
 "203.76.64.0/19"
 "203.76.164.0/22"
 "203.78.224.0/19"
 "203.79.48.0/20"
 "203.80.24.0/21"
 "203.81.112.0/20"
 "203.86.224.0/21"
 "203.88.176.0/20"
 "203.89.32.0/19"
 "203.89.128.0/22"
 "203.90.16.0/21"
 "203.91.160.0/19"
 "203.92.16.0/21"
 "203.95.16.0/21"
 "203.95.24.0/21"
 "203.95.32.0/19"
 "203.99.0.0/21"
 "203.99.72.0/21"
 "203.99.224.0/21"
 "203.99.240.0/21"
 "203.104.112.0/20"
 "203.104.128.0/20"
 "203.104.144.0/21"
 "203.104.152.0/22"
 "203.104.156.0/23"
 "203.104.158.0/24"
 "203.104.159.0/24"
 "203.105.64.0/19"
 "203.110.96.0/19"
 "203.110.224.0/21"
 "203.111.192.0/20"
 "203.111.240.0/21"
 "203.112.0.0/19"
 "203.112.32.0/19"
 "203.114.0.0/18"
 "203.114.192.0/19"
 "203.114.228.0/22"
 "203.114.248.0/22"
 "203.118.252.0/22"
 "203.119.1.0/24"
 "203.119.40.0/24"
 "203.124.6.0/23"
 "203.124.64.0/19"
 "203.129.96.0/20"
 "203.129.112.0/20"
 "203.129.160.0/19"
 "203.132.96.0/19"
 "203.133.128.0/19"
 "203.133.192.0/19"
 "203.133.224.0/21"
 "203.133.232.0/21"
 "203.133.240.0/21"
 "203.135.192.0/18"
 "203.142.192.0/20"
 "203.142.208.0/21"
 "203.143.96.0/19"
 "203.145.96.0/20"
 "203.145.120.0/21"
 "203.145.224.0/19"
 "203.147.112.0/20"
 "203.148.96.0/19"
 "203.149.96.0/20"
 "203.152.61.0/24"
 "203.152.192.0/19"
 "203.153.56.0/22"
 "203.153.64.0/20"
 "203.160.16.0/20"
 "203.167.32.0/19"
 "203.168.64.0/18"
 "203.169.8.0/21"
 "203.170.32.0/20"
 "203.170.52.0/22"
 "203.171.8.0/21"
 "203.171.212.0/22"
 "203.174.88.0/21"
 "203.174.192.0/19"
 "203.174.224.0/19"
 "203.175.16.0/20"
 "203.175.80.0/20"
 "203.184.96.0/19"
 "203.188.208.0/21"
 "203.189.32.0/19"
 "203.189.96.0/20"
 "203.191.136.0/21"
 "203.191.208.0/20"
 "203.191.224.0/20"
 "203.191.240.0/20"
 "203.192.96.0/19"
 "203.196.16.0/21"
 "203.196.64.0/20"
 "203.196.80.0/21"
 "203.196.88.0/23"
 "203.196.91.0/24"
 "203.201.52.0/22"
 "203.202.192.0/19"
 "203.205.96.0/20"
 "203.205.112.0/20"
 "203.207.48.0/22"
 "203.208.23.0/24"
 "203.209.176.0/22"
 "203.209.184.0/22"
 "203.210.88.0/22"
 "203.211.32.0/20"
 "203.211.48.0/21"
 "203.211.160.0/19"
 "203.211.192.0/19"
 "203.211.224.0/19"
 "203.212.32.0/19"
 "203.213.160.0/19"
 "203.215.56.0/22"
 "203.215.224.0/21"
 "203.216.128.0/19"
 "203.216.192.0/18"
 "203.217.156.0/22"
 "203.217.180.0/22"
 "203.222.208.0/20"
 "203.222.224.0/19"
 "203.223.24.0/21"
 "203.223.48.0/20"
 "203.223.80.0/21"
 "203.223.180.0/22"
 "206.3.0.0/19"
 "208.111.48.0/21"
 "210.1.144.0/20"
 "210.1.160.0/19"
 "210.2.192.0/18"
 "210.4.160.0/19"
 "210.4.240.0/20"
 "210.14.48.0/20"
 "210.48.128.0/21"
 "210.48.224.0/19"
 "210.56.160.0/19"
 "210.79.0.0/20"
 "210.79.32.0/20"
 "210.79.192.0/20"
 "210.87.224.0/20"
 "210.88.56.0/21"
 "210.88.188.0/22"
 "210.88.234.0/23"
 "210.89.0.0/19"
 "210.89.102.0/23"
 "210.89.192.0/18"
 "210.193.64.0/18"
 "210.203.192.0/18"
 "210.211.32.0/20"
 "210.211.48.0/21"
 "210.247.0.0/17"
 "216.8.0.0/20"
 "216.8.16.0/20"
 "216.171.112.0/20"
 "216.255.224.0/20"
 "217.178.0.0/16"
 "218.33.128.0/17"
 "218.100.15.0/24"
 "218.100.42.0/24"
 "218.100.45.0/24"
 "218.100.67.0/24"
 "218.185.128.0/18"
 "218.251.0.0/17"
 "219.66.0.0/15"
 "219.73.128.0/17"
 "219.75.128.0/17"
 "219.94.128.0/17"
 "220.100.0.0/17"
 "220.100.128.0/18"
 "220.100.192.0/18"
 "220.102.0.0/16"
 "220.146.0.0/15"
 "220.148.0.0/16"
 "220.150.0.0/20"
 "220.150.18.0/24"
 "220.150.19.0/24"
 "220.150.32.0/22"
 "220.150.36.0/23"
 "220.150.39.0/24"
 "220.150.40.0/22"
 "220.150.47.0/24"
 "220.150.48.0/20"
 "220.150.64.0/24"
 "220.150.65.0/24"
 "220.150.66.0/23"
 "220.150.80.0/23"
 "220.150.83.0/24"
 "220.150.84.0/22"
 "220.150.89.0/24"
 "220.150.96.0/19"
 "220.150.128.0/18"
 "220.150.192.0/23"
 "220.150.195.0/24"
 "220.150.197.0/24"
 "220.150.200.0/24"
 "220.150.201.0/24"
 "220.150.205.0/24"
 "220.150.208.0/21"
 "220.150.218.0/23"
 "220.150.223.0/24"
 "220.150.224.0/19"
 "220.151.0.0/16"
 "220.152.96.0/20"
 "220.152.120.0/21"
 "220.156.0.0/18"
 "220.156.64.0/19"
 "220.156.96.0/19"
 "220.156.128.0/19"
 "220.156.192.0/18"
 "220.157.0.0/18"
 "220.157.128.0/17"
 "220.158.0.0/17"
 "220.159.0.0/17"
 "220.159.128.0/17"
 "220.247.0.0/18"
 "220.247.64.0/18"
 "220.247.184.0/21"
 "220.254.0.0/17"
 "221.12.192.0/18"
 "221.120.168.0/21"
 "221.121.160.0/20"
 "221.121.176.0/21"
 "221.121.192.0/18"
 "221.132.96.0/20"
 "221.132.128.0/18"
 "221.133.64.0/18"
 "221.170.0.0/16"
 "221.171.0.0/16"
 "221.184.0.0/13"
 "221.240.0.0/12"
 "222.0.0.0/13"
 "222.8.0.0/16"
 "222.9.0.0/16"
 "222.10.0.0/15"
 "222.12.0.0/14"
 "222.144.0.0/13"
 "222.158.0.0/15"
 "222.224.0.0/17"
 "222.224.128.0/17"
 "222.225.0.0/16"
 "222.226.0.0/15"
 "222.228.0.0/16"
 "222.229.0.0/18"
 "222.229.64.0/20"
 "222.229.96.0/19"
 "222.229.128.0/17"
 "222.230.0.0/16"
 "222.231.64.0/18"
 "222.231.128.0/17"
 "223.25.128.0/18"
 "223.27.68.0/22"
 "223.27.72.0/21"
 "223.27.124.0/22"
 "223.27.180.0/22"
 "223.29.0.0/17"
 "223.29.176.0/20"
 "223.29.244.0/22"
 "223.132.0.0/14"
 "223.165.20.0/22"
 "223.165.32.0/19"
 "223.165.80.0/20"
 "223.216.0.0/14"
 "223.223.0.0/17"
 "223.223.160.0/22"
 "223.223.164.0/22"
 "223.223.208.0/21"
 "223.223.224.0/19"
 "223.252.64.0/19"
 "202.11.0.0/16"
 "202.13.0.0/16"
 "202.15.0.0/16"
 "202.23.0.0/16"
 "202.32.0.0/14"
 "202.48.0.0/16"
 "202.208.0.0/14"
 "203.136.0.0/14"
 "203.178.0.0/15"
 "210.128.0.0/13"
 "210.160.0.0/12"
 "210.188.0.0/14"
 "210.196.0.0/14"
 "210.224.0.0/15"
 "210.248.0.0/13"
 "211.0.0.0/13"
 "211.8.0.0/13"
 "211.120.0.0/13"
 "218.40.0.0/13"
 "218.110.0.0/16"
 "218.216.0.0/13"
 "219.96.0.0/11"
 "219.160.0.0/14"
 "219.166.0.0/15"
 "220.96.0.0/14"
 "220.104.0.0/13"
 "220.144.0.0/16"
 "220.208.0.0/12"
 "221.112.0.0/16"
)
ALLOW_GLOBAL_PORT="80,443"
ALLOW_LOCAL_HOSTS=(
	"192.168.1.0/24"
	"192.168.2.0/24"
)
ALLOW_LOCAL_PORT="80,443"
ALLOW_SSH_HOSTS=(
	"192.168.1.0/24"
	"192.168.2.0/24"
)
# ログの最大生成速度
LOG_LIMIT=60/m
LOG_LIMIT_BURST=1000
# ポート定義
SSH=`cat /etc/ssh/sshd_config | grep '^#\?Port ' | tail -n 1 | sed -e 's/^[^0-9]*\([0-9]\+\).*$/\1/'`
IDENT=113
initialize() 
{
	iptables -F # テーブル初期化
	iptables -X # チェーンを削除
	iptables -Z # パケットカウンタ・バイトカウンタをクリア
	iptables -P INPUT   ACCEPT
	iptables -P OUTPUT  ACCEPT
	iptables -P FORWARD ACCEPT
	if [ -z "$STRING" ]; then
	 $SSH=22 #処理
	fi
}
PolicyDecision()
{
	iptables -P INPUT   DROP # すべてDROP。すべての穴をふさいでから必要なポートを空けていくのが良い。
	iptables -P OUTPUT  ACCEPT #送信はすべて許可
	iptables -P FORWARD DROP
}
finailizeB()
{
	echo "Enter or y > save, n or timeout > revert"
	read -t 60 input
	if [ $? -eq 0 ] && [ "$input" != n ]; then
		service iptables save
		sysctl -p 2>&1 | grep -v -E "^error:.*(ipv6|bridge-nf-call)"
		service rsyslog restart
	else
		service iptables restart
	fi
	return 0
	return 1
}
finailize()
{
	/etc/init.d/iptables save && # 設定の保存
	/etc/init.d/iptables restart && # 保存したもので再起動してみる
	return 0
	return 1
}
###########################################################
# initialize
###########################################################
initialize
PolicyDecision
###########################################################
# 信頼ホスト許可
###########################################################
iptables -A INPUT -i lo -j ACCEPT # SELF -> SELF
#PRIVATE IP許可
if [ "${ALLOW_LOCAL_HOSTS}" ]
then
	for allow_prihost in ${ALLOW_LOCAL_HOSTS[@]}
	do
		iptables -A INPUT -p tcp -s $allow_prihost -m multiport --dports $ALLOW_LOCAL_PORT -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
	done
fi
###########################################################
# セッション確立後のパケット疎通は許可
###########################################################
iptables -A INPUT  -p tcp -m state --state ESTABLISHED,RELATED -j ACCEPT
###########################################################
#対策 start
###########################################################
# 送信元IPの偽装防止
sed -i '/net.ipv4.conf.*.rp_filter/d' /etc/sysctl.conf
for dev in `ls /proc/sys/net/ipv4/conf/`
do
    sysctl -w net.ipv4.conf.$dev.rp_filter=1 > /dev/null
    echo "net.ipv4.conf.$dev.rp_filter=1" >> /etc/sysctl.conf
done
# ICMP Redirectパケットを拒否
sed -i '/net.ipv4.conf.*.accept_redirects/d' /etc/sysctl.conf
for dev in `ls /proc/sys/net/ipv4/conf/`
do
    sysctl -w net.ipv4.conf.$dev.accept_redirects=0 > /dev/null
    echo "net.ipv4.conf.$dev.accept_redirects=0" >> /etc/sysctl.conf
done
# Source Routedパケットを拒否
sed -i '/net.ipv4.conf.*.accept_source_route/d' /etc/sysctl.conf
for dev in `ls /proc/sys/net/ipv4/conf/`
do
    sysctl -w net.ipv4.conf.$dev.accept_source_route=0 > /dev/null
    echo "net.ipv4.conf.$dev.accept_source_route=0" >> /etc/sysctl.conf
done
# ブロードキャストアドレス宛pingには応答しない
# ※Smurf攻撃対策
sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1 > /dev/null
sed -i '/net.ipv4.icmp_echo_ignore_broadcasts/d' /etc/sysctl.conf
echo "net.ipv4.icmp_echo_ignore_broadcasts=1" >> /etc/sysctl.conf
# SYN Cookiesを有効にする
# ※TCP SYN Flood攻撃対策
sysctl -w net.ipv4.tcp_syncookies=1 > /dev/null
sed -i '/net.ipv4.tcp_syncookies/d' /etc/sysctl.conf
echo "net.ipv4.tcp_syncookies=1" >> /etc/sysctl.conf
# システムの連続稼働時間を通知しない
# ※カーネルバージョン特定対策
sysctl -w net.ipv4.tcp_timestamps=1 > /dev/null
sed -i '/net.ipv4.tcp_timestamps/d' /etc/sysctl.conf
echo "net.ipv4.tcp_timestamps=1" >> /etc/sysctl.conf
# 攻撃を行っているIPを攻撃者として記録
iptables -N TRACK_ATTACKER 2>/dev/null
iptables -N ANTI_ATTACKER
iptables -N ANTI_ATTACKER_
iptables -A TRACK_ATTACKER -j ANTI_ATTACKER
iptables -A ANTI_ATTACKER -i e+ -j ANTI_ATTACKER_
iptables -A ANTI_ATTACKER -i p+ -j ANTI_ATTACKER_
iptables -A ANTI_ATTACKER -i w+ -j ANTI_ATTACKER_
iptables -A ANTI_ATTACKER_ -m recent --name attacker-rapid --update --rttl --seconds 10 -j RETURN
iptables -A ANTI_ATTACKER_ -m recent --name attacker-rapid --set
iptables -A ANTI_ATTACKER_ \
          -m hashlimit \
          --hashlimit-name attacker-rapid \
          --hashlimit-above 6/m \
          --hashlimit-mode srcip \
          --hashlimit-htable-expire 10000 \
          -j RETURN
iptables -A ANTI_ATTACKER_ -m recent --name attacker-fast --update --rttl --seconds 60 -j RETURN
iptables -A ANTI_ATTACKER_ -m recent --name attacker-fast --set
iptables -A ANTI_ATTACKER_ \
          -m hashlimit \
          --hashlimit-name attacker-fast \
          --hashlimit-above 1/m \
          --hashlimit-mode srcip \
          --hashlimit-htable-expire 60000 \
          -j RETURN
iptables -A ANTI_ATTACKER_ -m recent --name attacker-medium --update --rttl --seconds 3600 -j RETURN
iptables -A ANTI_ATTACKER_ -m recent --name attacker-medium --set
#iptables -A ANTI_ATTACKER_ -m recent --name attacker-slow --update --rttl --seconds 86400 -j RETURN
iptables -A ANTI_ATTACKER_ -m recent --name attacker-slow --set
# INVALIDpacket NG
iptables -N FW_INVALID 2>/dev/null
iptables -N DENY_INVALID
iptables -N DENY_INVALID_
iptables -A FW_INVALID -i e+ -j DENY_INVALID
iptables -A FW_INVALID -i p+ -j DENY_INVALID
iptables -A FW_INVALID -i w+ -j DENY_INVALID
iptables -A DENY_INVALID -m state --state INVALID -j DENY_INVALID_
iptables -A DENY_INVALID_ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-level debug --log-prefix 'INVALIDpacket : '
iptables -A DENY_INVALID_ -j DROP
# NetBIOS NG
iptables -N FW_NETBIOS 2>/dev/null
iptables -N DENY_NETBIOS
iptables -N DENY_NETBIOS_
iptables -A FW_NETBIOS -i e+ -j DENY_NETBIOS
iptables -A FW_NETBIOS -i p+ -j DENY_NETBIOS
iptables -A FW_NETBIOS -i w+ -j DENY_NETBIOS
iptables -A DENY_NETBIOS -p tcp -m multiport --dports 135,137,138,139,445 -j DENY_NETBIOS_
iptables -A DENY_NETBIOS -p udp -m multiport --dports 135,137,138,139,445 -j DENY_NETBIOS_
iptables -A DENY_NETBIOS_ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-level debug --log-prefix 'NETBIOS NG : '
iptables -A DENY_NETBIOS_ -j TRACK_ATTACKER
iptables -A DENY_NETBIOS_ -j DROP
# Stealth Scan
iptables -N STEALTH_SCAN
iptables -A STEALTH_SCAN -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-level debug --log-prefix "stealth_scan_attack: "
iptables -A STEALTH_SCAN -j TRACK_ATTACKER
iptables -A STEALTH_SCAN -j DROP

iptables -A INPUT -p tcp --tcp-flags SYN,ACK SYN,ACK -m state --state NEW -j STEALTH_SCAN
iptables -A INPUT -p tcp --tcp-flags ALL NONE -j STEALTH_SCAN

iptables -A INPUT -p tcp --tcp-flags SYN,FIN SYN,FIN         -j STEALTH_SCAN
iptables -A INPUT -p tcp --tcp-flags SYN,RST SYN,RST         -j STEALTH_SCAN
iptables -A INPUT -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j STEALTH_SCAN

iptables -A INPUT -p tcp --tcp-flags FIN,RST FIN,RST -j STEALTH_SCAN
iptables -A INPUT -p tcp --tcp-flags ACK,FIN FIN     -j STEALTH_SCAN
iptables -A INPUT -p tcp --tcp-flags ACK,PSH PSH     -j STEALTH_SCAN
iptables -A INPUT -p tcp --tcp-flags ACK,URG URG     -j STEALTH_SCAN

iptables -A INPUT -f -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-level debug --log-prefix 'fragment_packet:'
iptables -A INPUT -f -j DROP
# Ping of Death
iptables -N FW_PINGDEATH 2>/dev/null
iptables -N ANTI_PINGDEATH
iptables -N ANTI_PINGDEATH_
iptables -A FW_PINGDEATH -i e+ -p icmp --icmp-type echo-request -j ANTI_PINGDEATH
iptables -A FW_PINGDEATH -i p+ -p icmp --icmp-type echo-request -j ANTI_PINGDEATH
iptables -A FW_PINGDEATH -i w+ -p icmp --icmp-type echo-request -j ANTI_PINGDEATH
iptables -A ANTI_PINGDEATH -j ANTI_PINGDEATH_
iptables -A ANTI_PINGDEATH_ \
          -m hashlimit \
          --hashlimit-name ping \
          --hashlimit 1/s \
          --hashlimit-burst 4 \
          --hashlimit-mode srcip \
          --hashlimit-htable-expire 1000 \
          -j RETURN
iptables -A ANTI_PINGDEATH_ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-level debug --log-prefix 'Ping_of_Death : '
iptables -A ANTI_PINGDEATH_ -j TRACK_ATTACKER
iptables -A ANTI_PINGDEATH_ -j DROP
# ※IP spoofing攻撃対策
iptables -N FW_SPOOFING 2>/dev/null
iptables -N ANTI_SPOOFING
iptables -N ANTI_SPOOFING_
iptables -N ANTI_SPOOFING__
iptables -A FW_SPOOFING -j ANTI_SPOOFING
iptables -A ANTI_SPOOFING -i e+ -j ANTI_SPOOFING_
iptables -A ANTI_SPOOFING -i p+ -j ANTI_SPOOFING_
iptables -A ANTI_SPOOFING -i w+ -j ANTI_SPOOFING_
iptables -A ANTI_SPOOFING_ -s 127.0.0.0/8    -j ANTI_SPOOFING__
iptables -A ANTI_SPOOFING_ -s 10.0.0.0/8     -j ANTI_SPOOFING__
iptables -A ANTI_SPOOFING_ -s 172.16.0.0/12  -j ANTI_SPOOFING__
iptables -A ANTI_SPOOFING_ -s 192.168.0.0/16 -j ANTI_SPOOFING__
iptables -A ANTI_SPOOFING__ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-level debug --log-prefix 'IP_spoofing : '
iptables -A ANTI_SPOOFING__ -j TRACK_ATTACKER
iptables -A ANTI_SPOOFING__ -j DROP
# DDoS Attack
# HTTP
iptables -N FW_SYNFLOOD 2>/dev/null
iptables -N ANTI_SYNFLOOD
iptables -N ANTI_SYNFLOOD_
iptables -A FW_SYNFLOOD -p tcp --dport 80 -j ANTI_SYNFLOOD
iptables -A ANTI_SYNFLOOD -i e+ -p tcp -m state --state NEW -j ANTI_SYNFLOOD_
iptables -A ANTI_SYNFLOOD -i p+ -p tcp -m state --state NEW -j ANTI_SYNFLOOD_
iptables -A ANTI_SYNFLOOD -i w+ -p tcp -m state --state NEW -j ANTI_SYNFLOOD_
iptables -A ANTI_SYNFLOOD_ \
          -m hashlimit \
          --hashlimit-name http \
          --hashlimit 10/m \
          --hashlimit-burst 60 \
          --hashlimit-mode srcip \
          --hashlimit-htable-expire 60000 \
          -j RETURN
iptables -A ANTI_SYNFLOOD_ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-prefix 'DDoS Attack(HTTP) : '
iptables -A ANTI_SYNFLOOD_ -j DROP
# HTTPS
iptables -N FW_SYNFLOOD_SSL 2>/dev/null
iptables -N ANTI_SYNFLOOD_SSL
iptables -N ANTI_SYNFLOOD_SSL_
iptables -A FW_SYNFLOOD_SSL -p tcp --dport 443 -j ANTI_SYNFLOOD_SSL
iptables -A ANTI_SYNFLOOD_SSL -i e+ -p tcp -m state --state NEW -j ANTI_SYNFLOOD_SSL_
iptables -A ANTI_SYNFLOOD_SSL -i p+ -p tcp -m state --state NEW -j ANTI_SYNFLOOD_SSL_
iptables -A ANTI_SYNFLOOD_SSL -i w+ -p tcp -m state --state NEW -j ANTI_SYNFLOOD_SSL_
iptables -A ANTI_SYNFLOOD_SSL_ \
          -m hashlimit \
          --hashlimit-name https \
          --hashlimit 30/m \
          --hashlimit-burst 60 \
          --hashlimit-mode srcip \
          --hashlimit-htable-expire 60000 \
          -j RETURN
iptables -A ANTI_SYNFLOOD_SSL_ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-prefix 'DDoS Attack(HTTPS) : '
iptables -A ANTI_SYNFLOOD_SSL_ -j DROP
# UDP
iptables -N FW_UDPFLOOD 2>/dev/null
iptables -N ANTI_UDPFLOOD
iptables -N ANTI_UDPFLOOD_
iptables -A FW_UDPFLOOD -j ANTI_UDPFLOOD
iptables -A ANTI_UDPFLOOD -i e+ -p udp -m state --state NEW -j ANTI_UDPFLOOD_
iptables -A ANTI_UDPFLOOD -i p+ -p udp -m state --state NEW -j ANTI_UDPFLOOD_
iptables -A ANTI_UDPFLOOD -i w+ -p udp -m state --state NEW -j ANTI_UDPFLOOD_
iptables -A ANTI_UDPFLOOD_ \
          -m hashlimit \
          --hashlimit-name udp \
          --hashlimit 30/m \
          --hashlimit-burst 60 \
          --hashlimit-mode srcip \
          --hashlimit-htable-expire 60000 \
          -j RETURN
iptables -A ANTI_UDPFLOOD_ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-prefix 'DDoS Attack(UDP) : '
iptables -A ANTI_UDPFLOOD_ -j DROP
# ICMP
iptables -N FW_ICMPFLOOD 2>/dev/null
iptables -N ANTI_ICMPFLOOD
iptables -N ANTI_ICMPFLOOD_
iptables -A FW_ICMPFLOOD -j ANTI_ICMPFLOOD
iptables -A ANTI_ICMPFLOOD -i e+ -p icmp -j ANTI_ICMPFLOOD_
iptables -A ANTI_ICMPFLOOD -i p+ -p icmp -j ANTI_ICMPFLOOD_
iptables -A ANTI_ICMPFLOOD -i w+ -p icmp -j ANTI_ICMPFLOOD_
iptables -A ANTI_ICMPFLOOD_ \
          -m hashlimit \
          --hashlimit-name icmp \
          --hashlimit 30/m \
          --hashlimit-burst 60 \
          --hashlimit-mode srcip \
          --hashlimit-htable-expire 60000 \
          -j RETURN
iptables -A ANTI_ICMPFLOOD_ -m limit --limit $LOG_LIMIT --limit-burst $LOG_LIMIT_BURST -j LOG --log-prefix 'DDoS Attack(ICMP) : '
iptables -A ANTI_ICMPFLOOD_ -j DROP
# IDENT port probe
iptables -A INPUT -p tcp -m multiport --dports $IDENT -j REJECT --reject-with tcp-reset
# ブロードキャストアドレス、マルチキャストアドレス宛パケットは破棄
iptables -A INPUT -d 192.168.1.255   -j DROP
iptables -A INPUT -d 255.255.255.255 -j DROP
iptables -A INPUT -d 224.0.0.1       -j DROP
###########################################################
#対策　end
###########################################################
###########################################################
# IP許可
###########################################################
#GROBAL IP許可
if [ "${ALLOW_ROUGHLY_HOSTS}" ]
then
	for allow_grohost in ${ALLOW_ROUGHLY_HOSTS[@]}
	do
		iptables -A INPUT -p tcp -s $allow_grohost -m multiport --dports $ALLOW_GLOBAL_PORT -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
	done
fi
#SSH IP許可
if [ "${ALLOW_SSH_HOSTS}" ]
then
	for allow_sshhost in ${ALLOW_SSH_HOSTS[@]}
	do
		iptables -A INPUT -p tcp -s $allow_sshhost -m multiport --dports $SSH -j ACCEPT # LIMITED_LOCAL_NET -> SELF
	done
fi
###########################################################
# throughput 
###########################################################
#ポート443の通信のTOSを高スループットのものへ書き換え
iptables -t mangle -A PREROUTING -p tcp --dport 443 -j TOS --set-tos Maximize-Throughput
###########################################################
# finailize
###########################################################
iptables -A INPUT  -j LOG --log-prefix "drop: "
iptables -A INPUT  -j DROP
trap 'finailize && exit 0' 2 || trap 'finailizeB && exit 0' 2 # Ctrl-C をトラップする
echo "If there is no problem then press Ctrl-C to finish."
sleep 30
echo "rollback..."
initialize